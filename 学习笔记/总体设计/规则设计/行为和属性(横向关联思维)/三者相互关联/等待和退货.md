### ==顾客==

----

等待和骑手退货

##### 1、等待超时提醒(顾客)

###### 1.1、提醒

顾客端会被提醒，由于您未及时收货，骑手正在配送其他订单中，如需再次配送，请在10分钟内点击“确定”，否则将进入退货流程，点击了取消，提醒顾客，您将支付回程配送费，超出了10分钟，订单已经进入了自动退货流程，请您在24小时内支付给骑手回程配送费，否则会定性为失信行为。在顾客没有支付回程配送费的时间内，顾客不能再次使用到付权利。

###### 1.2、未支付返程配送费的失信行为

如果顾客不支付返程配送费，那么会被定性为失信行为，扣除所有的信用分。如果顾客点击了二次配送，系统会提醒顾客，您需等待骑手配送完其他订单，他将再次配送你的订单，预计需要您等待20分钟(具体时间会自动计算)。

###### 1.3、二次配送失信行为

顾客点击了确定同意二次配送后，第二次配送到门口时，骑手还是等待顾客超时5分钟，那么顾客会定性为失信行为，顾客的信用分将会被全部扣除。此时此单会直接进入退货流程。

##### 2、二次配送(顾客)

在挂起的这10分钟内，顾客联系了骑手 ，就会进入第二次配送流程，此时需要支付1.5倍的配送费或者按距离计算的配送费(具体倍率或规则由商家设定)。

###### 2.1、二次配送的时间计算

二次配送的时间计算: 是按骑手配送的最后一单和被挂起这单之间的距离计算的。

###### 2.2、二次配送的配送费

额外追加的配送费:是通过距离来计算的，当然也需要起步价，这些都有商家设定。

##### 3、自动提醒顾客

只要骑手进入顾客的定位范围，那么就会自动的提醒顾客骑手已经快到了，请保持通话畅通。

##### 4、等待超时指引视频(顾客)

[查看详情](..\两者相互关联\骑手和顾客关联\路线指引视频.md)



----





### ==骑手==

----



### 等待和退货

##### 1、等待时间计算(骑手)

如果等待超过5分钟(等待时间的计算是从联系顾客起开始计算的)，骑手能直接配送下一单，这单会通过点击等待顾客超时按钮，而被挂起10分钟(具体时间有商家设置)，接下来骑手就能去配送其他订单了。联系顾客的等待时间的计算，同时会考虑到骑手是否离顾客很近(比如20米范围内)，如果在此范围外联系顾客不会自动计算等待时间，比如骑手刚刚接单就联系顾客，那么就不会计算等待时间了。为了避免多次联系顾客打扰顾客，会设计一个按钮，当到达顾客附近(比如直径20米内)，就能点击计算等待时间了。

> 被配挂起的触发者是骑手，而不是自动的，挂起的时间是由商家设置的，能挂起10分钟、15分钟，不支持挂起时间太久，避免浪费骑手的太多时间。

##### 2、订单挂起(骑手)

如果被挂起的这10分钟内，顾客还是没有联系骑手，那么这个订单会直接进入退货流程，此时顾客需要获取骑手的收款二维码，主动付款，否则会扣除信用分。==如果是很多订单被挂起，按顾客点击的确认配送的时间顺序来重新配送==

##### 3、骑手退货(骑手)

退货流程，骑手在商家规定的时间内把货物完好的归还商家，商家如约退还骑手支付的金额，商家再支付一定的返程配送费给骑手，顾客当支付的那部分返程费由顾客支付。骑手一直都是为商家和顾客服务的，在返程配送费方面，由商家和顾客去分摊，返程配送费的分摊规则由商家设定。

骑手等待顾客时长会自动为每一位顾客计算，这些计算给骑手参考，让骑手更加方便的做决策。

##### 4、等待超时指引视频(骑手)

[查看详情](..\两者相互关联\骑手和顾客关联\路线指引视频.md)



##### 5、展示处罚顾客的结果给骑手

顾客拒绝支付回程配送费的话，将计入顾客的失信行为，将会在一段时间内限制购买后付费的商品，只能购买先付费的商品。系统会提醒骑手，顾客已经纳入失信，在1个月内无法购买后付费的订单，顾客想要申请解除限制，就需要向此骑手支付配送费和返程配送费。



----







### ==商家==

----



##### 9、等待和退货

##### 规则设定(商家)

等待超时被挂起的时间设置，10分钟、15分钟。

二次配送的时间计算，每公里增加5分钟(默认)，商家可以自行设定。

二次配送费的起步价，每公里加2元，商家自行设定。

商品退还的时间、返程配送费，超时责任。

每个商家的规则设置都会写入到一个`json`文件中，然后上传到服务器，当前端要使用的时候将会从服务器中拉取，如此就能把哪些规则实现了。

由于第二次配送等待时间过长，订单准备退回给商家，商家应当按自己的规则退款给骑手，规则为多长时间内归还能免除扣款。顾客已经定性为失信行为了。



----













### ==废弃的思路==

----



##### 2、等待超过5分钟

###### 2.1、未取货

~~如果等待超过5分钟，点击顾客未取货，订单进入待退货，同时顾客也会受到下单限制，这些信息也会暴露给骑手们参考。~~~~把等候补贴取消，改为等候超过5分钟就能取消订单，改为退货状态~~

###### 2.2、自动计时

只要骑手进入顾客的定位范围，那么就会自动的提醒顾客骑手已经快到了，骑手联系了顾客，~~系统就会自动计算等候时间，超过5分钟骑手就能自己选择是否取消订单。~~

###### 2.3、恶意等待5分钟

~~当然要避免骑手恶意的等待5分钟，也不联系顾客，然后就点击顾客未取货，使得顾客因骑手而受到处罚，因此需要顾客自己获取骑手的收款码，顾客自己把回程配送费转给此骑手，以此消除负面影响，同时旁边有拉黑此骑手的按钮。~~==处罚过重了，所以废弃==

我想很少有骑手会恶意等待5分钟，要避免这种情况，自动计时就需要在联系了顾客后，才会自动计时。

~~一个骑手被多少人拉黑过，都会展示给顾客参考。顾客也能选择不给被被其他顾客拉黑100次的骑手接单。~~

~~在什么情况下，骑手才能评价等候顾客时间太长呢，只能在顾客第二次下单的时候。首次下单的顾客，骑手不能评价。顾客第一次下单，同一个订单会因为等待问题存在两次配送，第二次配送骑手等待时间过长，此时也能评价顾客。~~

----

